=== Auto Alt Text ===
Contributors: valeriomonti
Donate link: https://ko-fi.com/valeriomonti
Tags: alt text, alt tag, accessibility, openai, seo
Requires at least: 6.0
Tested up to: 6.7.2
Stable tag: 2.4.1
Requires PHP: 7.4
License: GPLv3
License URI: http://www.gnu.org/licenses/gpl.html

This plugin allows you to automatically generate an Alt Text for images uploaded into the media library via AI.

== Description ==

This plugin implements the automatic creation of alt text for images uploaded to the media library. The alt text is generated at the time of uploading the image and it is also possible to generate the alt text for images already present in the media library.

To generate the alt text, you can choose to use the artificial intelligence of OpenAI or Azure, or decide if you simply want to copy the title of the article where the image is uploaded or the name of the image.

Clearly, using artificial intelligence will allow for a more accurate and useful alt texts.

## Features
___
This plugin allows you to generate alt texts in the following ways:
- using Openai APIs (GPT-4o, GPT-4o Mini, o1 Mini)
- using Azure APIs for computational vision;
- recovering the title of the image
- recovering the title of the article in which the image is uploaded


= Getting Started =
After installing the plugin, click on the 'Auto Alt Text' menu item.

## Choice of Generation Method
Select the Generation Method you prefer

### OpenAI's APIs
In your OpenAI account, retrieve the following data to enter on the options page:
- API Key

Enter a prompt for generating the alt text according to your needs.

### Azure's APIs
On your Azure account, create a Computer Vision instance and retrieve the following data to enter on the options page:
- Computer Vision API Key
- Computer Vision Endpoint

If you want to generate an alt text in English, save the options without filling in any other fields.

If you want to generate an alt text in a different language, on your Azure account, create a Translator instance and retrieve the following data to enter on the options page:
- Translator Instance API Key
- Translator Instance Endpoint
- Translator Instance Region

After entering this data, save the options.

Select the desired language and save the options again.

### Title of the article
For this generation method, there are no options to set as the alt text will be generated by copying the title of the article in which the image is uploaded.

In case the article is not uploaded as an attachment of an article, the "Title of the attachment" method will be used as a fallback.

### Title of the attachment
For this generation method, there are no options to set as the alt text will be generated by copying the title of the image.

## Functioning
Once the plugin is configured, each time an image is uploaded to the media library, an alt text will be automatically set based on the selected generation method.

For images already in the media library, you can create bulk alt texts. Open the Media Library in the "list" view, select the images for which to generate the alt text, and choose the "Generate alt text" bulk action. (Depending on the number of images chosen and their weight, this may take some time.)

You can also generate the alt text of a single image directly from the media library. Open the Media Library in “grid” mode, choose the image for which to generate the alt text, and click the “Generate alt text” button. In no time the alt text field will be overwritten by the generated description.

**Notice**: If you choose one of the methods that involves the use of external APIs, the upload times for images in the media library might increase because it requires sending a request to the APIs, waiting for the external server to process, and waiting for a response.

### Logging
If the generation of the alt text via AI is set, in case of errors, to avoid blocking the editorial work, the image is loaded anyway but without the alt text being compiled.

When a call to the Azure or OpenAI API fails, a record containing the error message is saved in a custom database table.
In this case, the cause of the error can be seen on the Auto Alt Text -> Error log page.

## External Services
This plugin uses the following external services alternatively:

### OpenAI
Selecting the generation method "OpenAI's APIs" will use the API services of [OpenAI](https://openai.com/).

This plugin does not collect any information from your OpenAI account. The data transmitted to OpenAI mainly consists of the image files uploaded to your website and the specified prompt.

For accurate information on privacy and conditions of use, please consult the [privacy policy](https://openai.com/policies/privacy-policy) and [terms and conditions](https://openai.com/) directly on the official website. It is also advisable to check the costs and usage statistics of the API service on the OpenAI website.

### Azure
Selecting the "Azure's APIs" generation method will use the API services of [Microsoft Azure](https://azure.microsoft.com/en-us/).

This plugin does not collect any information from your Azure account. The data transmitted to Azure consists mainly of image files uploaded to your website.

For accurate information on privacy and conditions of use, please directly consult the [privacy policy](https://privacy.microsoft.com/en-us/privacystatement) and [terms and conditions](https://azure.microsoft.com/en-us/support/legal/) on the official website. It is also advisable to check the costs and usage statistics of the API service on the Microsoft Azure's website.

## Encryption Constants

We **strongly recommend** defining the new plugin-specific constants in your `wp-config.php`:

`define( 'AAT_ENCRYPTION_KEY',  'a_random_string_of_at_least_64_characters' );`
`define( 'AAT_ENCRYPTION_SALT', 'another_random_string_of_at_least_64_characters' );`

You will find these two define(...) lines already generated for you on the Auto Alt Text » Options page – simply copy & paste them before the `/* That's all, stop editing! Happy publishing. */` line in your `wp-config.php`.

If you choose not to add them, the plugin will continue to work normally, but it will fall back to using your WordPress `LOGGED_IN_KEY` / `LOGGED_IN_SALT`, which may break if those salts are ever changed.

## Disclaimer
Auto Alt Text is a plugin that helps users automatically generate Alt Texts of their images using AI services such as OpenAI's ChatGPT or Microsoft Azure.
Users need their own API key and must follow the rules set by the AI service they choose.

By using Auto Alt Text, users agree to watch and manage AI-made content and address any issues or misuse.

AI Engine developer and related parties are not responsible for any problems or losses caused by the use of the plugin or AI-generated content.


== Frequently Asked Questions ==

= Is it mandatory to use external AI services? =
No, but if you want to leverage the capabilities of AI, you must have an Azure or OpenAI account. Otherwise, you can choose one of the two methods that do not use AI.

= Which generation method should I choose to obtain an accurate description of the image? =
If you wish to obtain the most accurate description possible of the image, you should use the "OpenAI's APIs" or "Azure's APIs" method.

= Why do I see the error “There was a problem with the encryption of your API Key for alt text generation. Please re-enter the key and save”? =

This message appears because the plugin was unable to decrypt your stored API Key. In most cases this happens when the cryptographic “salt” or “key” it originally used to encrypt your API Key has changed since you first saved it.

**Common causes**
- You (or another plugin) have changed the WordPress authentication salts (`LOGGED_IN_KEY` / `LOGGED_IN_SALT`) in your `wp-config.php` after saving the API Key.
- You haven’t defined the recommended plugin-specific constants (`AAT_ENCRYPTION_KEY` / `AAT_ENCRYPTION_SALT`) in your `wp-config.php`, so the plugin fell back to the WordPress salts.

**How to fix**
1. Go to **Auto Alt Text » Options** in your WordPress admin.
2. Re-enter your API Key in the appropriate field and click **Save Changes**.
3. _(Recommended)_ Prevent this issue in the future by adding these lines **before** the `/* That's all, stop editing! Happy publishing. */` comment in your `wp-config.php`:
   ```
   define( 'AAT_ENCRYPTION_KEY',  'a_random_string_of_at_least_64_characters' );
   define( 'AAT_ENCRYPTION_SALT', 'another_random_string_of_at_least_64_characters' );
   ```

This ensures the plugin uses stable, plugin-specific values for encryption and won’t break if WordPress salts are ever changed again.

Once you’ve re-entered your API Key (and, if desired, added the constants), hit Save Changes — the plugin will re-encrypt your key correctly and the error will disappear

== Screenshots ==

1. Azure's APIs method options page
2. OpenAI's APIs method options page
3. Title of the article options page
4. Title of the attachment options page
5. Bulk alt text generation
6. Single image alt text generation

== Changelog ==
= 2.4.1 =
- Fixed: Alt text now correctly persists when generated from both the post media overlay and the main Media Library.

= 2.4.0 =
- Introduce two new plugin-specific constants, `AATXT_ENCRYPTION_KEY` and `AATXT_ENCRYPTION_SALT`, allowing API keys to be encrypted independently of WordPress’s own salts.
- Implement automatic migration of existing encrypted API keys: on upgrade, keys encrypted with the old WP salts are decrypted (if possible) and re-encrypted with the new plugin key.
- Add an optional info notice on the Auto Alt Text options page showing the ready-to-copy `define()` statements for `wp-config.php`.
- Maintain full backward-compatibility: if the new constants are not defined, the plugin continues to use the WordPress `LOGGED_IN_KEY`/`LOGGED_IN_SALT` fallback without interruption.

= 2.3.4 =
- Displays an error message in the administration area if the WordPress salt keys were changed after the OpenAI API key was set. The message asks the user to enter the OpenAI API key again.
- Update npm packages

= 2.3.3 =
- Fix a return type error in the alt text generation

= 2.3.2 =
- Avoid generating alt text for not supported mime types
- Hide the 'Generate Alt Text' button in media library for unsupported mime types
- Update npm packages

= 2.3.1 =
- Tested up to WordPress 6.7.2

= 2.3.0 =
- Preserves alt tags already present in images by preventing them from being overwritten by those generated by the plugin
- Update npm packages

= 2.2.0 =
- Allow users to select the preferred Openai model for generating alt text

= 2.1.0 =
- Allow users to generate the alt text for each individual image in the media library

= 2.0.0 =
- Set a maximum timeout of 90 seconds for OpenAI requests
- Implement the gpt-4o model for generating alt text
- Implement gpt-4-turbo template for fallback alt text generation
- Remove gpt-4 and gpt-3.5 templates as fallback options

= 1.3.0 =
- Implement bulk alt text generation for images already in the media library
- Update Vite package
- Implement github actions for automatic release

= 1.2.4 =
- Code refactoring
- DB security improvements

= 1.2.3 =
- Code refactoring

= 1.2.2 =
- Add Database log management
- Escape all output
- Add AATXT_ prefix
- Update Vite package
- Remove file log management

= 1.0.0 =
- Plugin released

== Upgrade Notice ==
- Plugin released
